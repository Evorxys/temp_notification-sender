<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flask Notification App</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <h1>ðŸ“± Flask Notification App</h1>
        <p>Notifications will appear on your Android Chrome browser.</p>
        <button id="manualNotify">Show Notification Now</button>
    </div>

<script>
async function requestPermission() {
    if (!("Notification" in window)) {
        alert("Notifications are not supported by your browser.");
        return;
    }

    let permission = Notification.permission;
    if (permission !== "granted") {
        permission = await Notification.requestPermission();
    }

    if (permission === "granted") {
        console.log("âœ… Notification permission granted");
        scheduleNotification();
    } else {
        alert("Please enable notifications in your browser settings.");
    }
}

function showNotification(title, body) {
    const options = {
        body: body,
        icon: "https://cdn-icons-png.flaticon.com/512/1827/1827370.png",
        vibrate: [200, 100, 200],
        requireInteraction: false // auto-dismiss
    };
    new Notification(title, options);
}

function scheduleNotification() {
    // Timed notification after 10 seconds
    setTimeout(() => {
        showNotification("â° Reminder", "This is your timed notification!");
    }, 10000);
}

document.addEventListener("DOMContentLoaded", () => {
    requestPermission();

    document.getElementById("manualNotify").addEventListener("click", () => {
        if (Notification.permission === "granted") {
            showNotification("ðŸ“¢ Manual Notification", "You clicked the button!");
        } else {
            alert("Please enable notifications first.");
        }
    });
});
</script>

</body>
</html>
